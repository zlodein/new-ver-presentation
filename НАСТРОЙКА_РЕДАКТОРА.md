# Настройка редактора презентаций (подсказки адресов, GigaChat, метро)

Ошибки **ERR_CONNECTION_REFUSED** на `localhost:3002/suggest` и «текст не генерируется, адрес не работает» означают, что **бэкенд (Node-сервер) не запущен** или фронтенд обращается не на тот адрес.

## Что сделать по шагам

### 1. Настроить переменные окружения бэкенда

В папке **server** создайте файл **`.env`** (если его ещё нет), скопировав из примера:

```bash
cd server
copy .env.example .env
```

Откройте **`server/.env`** и проверьте:

- **`PORT=3002`** — порт, на котором будет работать API (должен совпадать с тем, что указан во фронтенде в `VITE_API_URL`).
- **`GIGACHAT_AUTH_KEY`** — ключ GigaChat (уже подставлен в `.env.example`; при необходимости замените на свой).
- **`YANDEX_GEOCODER_API_KEY`** — ключ Яндекс.Карт (уже подставлен в `.env.example`; при необходимости замените на свой).
- **`JWT_SECRET`** — любая строка не короче 32 символов (для авторизации).

Остальные переменные (например, `DATABASE_URL`) можно не трогать, если используете хранение в файле.

### 2. Указать адрес API во фронтенде

В **корне проекта** (не в `server`) откройте файл **`.env`**.

Должна быть строка:

```env
VITE_API_URL=http://localhost:3002
```

Порт (**3002**) должен совпадать с **`PORT`** в **`server/.env`**. Если сервер у вас на другом порту — измените оба места.

### 3. Запустить бэкенд (Node-сервер)

В отдельном терминале:

```bash
cd server
npm install
npm run dev
```

В консоли должно появиться что-то вроде: «Server listening at http://0.0.0.0:3002». Пока этот процесс запущен, запросы на `http://localhost:3002/suggest`, `http://localhost:3002/generate_text`, `http://localhost:3002/find_nearest_metro` будут обрабатываться.

### 4. Запустить фронтенд (Vue)

В **другом** терминале, из корня проекта:

```bash
npm run dev
```

Откройте в браузере адрес, который покажет Vite (обычно `http://localhost:5173`). Редактор презентаций будет ходить на `VITE_API_URL` (localhost:3002), и подсказки адресов, генерация текста (GigaChat) и поиск метро должны заработать.

---

## Кратко

| Проблема | Решение |
|----------|--------|
| `ERR_CONNECTION_REFUSED` на localhost:3002 | Запустить бэкенд: `cd server && npm run dev` |
| Подсказки адресов не работают | В `server/.env` задать `YANDEX_GEOCODER_API_KEY` и перезапустить сервер |
| Текст не генерируется (GigaChat) | В `server/.env` задать `GIGACHAT_AUTH_KEY` и перезапустить сервер |
| Метро не ищется | Тот же `YANDEX_GEOCODER_API_KEY` в `server/.env` |
| «GigaChat не настроен» / «Подсказки адресов не настроены» | На **сервере** (e-presentation.ru) в `server/.env` или в переменных окружения процесса задать `GIGACHAT_AUTH_KEY` и/или `YANDEX_GEOCODER_API_KEY` и перезапустить бэкенд |
| 404 (File not found) | Смотрите, какой именно URL даёт 404 — это может быть другой сервис (не Node API). |

После изменения **`server/.env`** или **корневого `.env`** нужно перезапустить соответственно сервер или фронтенд (npm run dev).
