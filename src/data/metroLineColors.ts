/**
 * Официальные цвета линий Московского метро (HEX).
 * Источник: схема метро Москвы (mosmetro.ru, транспорт Москвы).
 * Станции сопоставлены линиям для отображения цветной точки.
 */
const L1 = '#ED1B35' // Сокольническая
const L2 = '#44B85C' // Замоскворецкая
const L3 = '#0078BF' // Арбатско-Покровская
const L4 = '#19CECE' // Филёвская
const L5 = '#894E35' // Кольцевая
const L6 = '#F58631' // Калужско-Рижская
const L7 = '#8E4798' // Таганско-Краснопресненская
const L8 = '#FFCB00' // Калининская
const L9 = '#A1A2A3' // Серпуховско-Тимирязевская
const L10 = '#B4D445' // Люблинско-Дмитровская
const L11 = '#79CDCD' // Каховская
const L12 = '#ACBFE1' // Бутовская
const L13 = '#84C2CE' // Монорельс (не используется для станций метро)
const L14 = '#E7999C' // Некрасовская
const L15 = '#8E4798' // ТПК (Таганско-Краснопресненская часть)

/** Название станции (нормализованное: trim, lowercase) -> цвет линии */
const STATION_TO_COLOR: Record<string, string> = {}

function addStations(hex: string, names: string[]) {
  names.forEach((n) => {
    STATION_TO_COLOR[n.trim().toLowerCase()] = hex
  })
}

// Сокольническая (1)
addStations(L1, [
  'Бульвар Рокоссовского', 'Черкизовская', 'Преображенская площадь', 'Сокольники', 'Красносельская', 'Комсомольская', 'Красные ворота', 'Чистые пруды', 'Лубянка', 'Охотный ряд', 'Библиотека имени Ленина', 'Кропоткинская', 'Парк культуры', 'Фрунзенская', 'Спортивная', 'Воробьёвы горы', 'Университет', 'Проспект Вернадского', 'Юго-Западная', 'Тропарёво', 'Румянцево', 'Саларьево', 'Филатов луг', 'Прокшино', 'Ольховая', 'Коммунарка',
])
// Замоскворецкая (2)
addStations(L2, [
  'Ховрино', 'Беломорская', 'Речной вокзал', 'Водный стадион', 'Войковская', 'Сокол', 'Аэропорт', 'Динамо', 'Полежаевская', 'Панфиловская', 'Щукинская', 'Тушинская', 'Спартак', 'Сходненская', 'Планерная', 'Технопарк', 'Коломенская', 'Каширская', 'Кантемировская', 'Царицыно', 'Орехово', 'Домодедовская', 'Красногвардейская', 'Алма-Атинская', 'Тверская', 'Маяковская', 'Белорусская', 'Площадь Гагарина', 'Курская', 'Павелецкая', 'Автозаводская',
])
// Арбатско-Покровская (3)
addStations(L3, [
  'Щёлковская', 'Первомайская', 'Измайловская', 'Партизанская', 'Семёновская', 'Электрозаводская', 'Бауманская', 'Курская', 'Площадь Революции', 'Арбатская', 'Смоленская', 'Киевская', 'Парк Победы', 'Славянский бульвар', 'Кунцевская', 'Молодёжная', 'Крылатское', 'Строгино', 'Мякинино', 'Волоколамская', 'Митино', 'Пятницкое шоссе',
])
// Филёвская (4)
addStations(L4, [
  'Кунцевская', 'Пионерская', 'Филёвский парк', 'Багратионовская', 'Фили', 'Кутузовская', 'Студенческая', 'Киевская', 'Смоленская', 'Арбатская', 'Александровский сад',
])
// Кольцевая (5)
addStations(L5, [
  'Парк культуры', 'Киевская', 'Краснопресненская', 'Белорусская', 'Новослободская', 'Проспект Мира', 'Комсомольская', 'Курская', 'Таганская', 'Павелецкая', 'Добрынинская', 'Октябрьская', 'Парк культуры',
])
// Калужско-Рижская (6)
addStations(L6, [
  'Медведково', 'Бабушкинская', 'Свиблово', 'Ботанический сад', 'ВДНХ', 'Алексеевская', 'Рижская', 'Проспект Мира', 'Сухаревская', 'Тургеневская', 'Китай-город', 'Третьяковская', 'Октябрьская', 'Шаболовская', 'Ленинский проспект', 'Академическая', 'Профсоюзная', 'Новые Черёмушки', 'Калужская', 'Беляево', 'Коньково', 'Тёплый Стан', 'Ясенево', 'Новоясеневская',
])
// Таганско-Краснопресненская (7)
addStations(L7, [
  'Планерная', 'Сходненская', 'Тушинская', 'Щукинская', 'Октябрьское поле', 'Панфиловская', 'Полежаевская', 'Беговая', 'Улица 1905 года', 'Баррикадная', 'Пушкинская', 'Кузнецкий мост', 'Китай-город', 'Таганская', 'Пролетарская', 'Волгоградский проспект', 'Текстильщики', 'Кузьминки', 'Рязанский проспект', 'Выхино', 'Лермонтовский проспект', 'Жулебино', 'Котельники',
])
// Калининская (8)
addStations(L8, [
  'Новокосино', 'Новогиреево', 'Перово', 'Шоссе Энтузиастов', 'Авиамоторная', 'Площадь Ильича', 'Марксистская', 'Третьяковская', 'Третьяковская',
])
// Серпуховско-Тимирязевская (9)
addStations(L9, [
  'Алтуфьево', 'Бибирево', 'Отрадное', 'Владыкино', 'Петровско-Разумовская', 'Тимирязевская', 'Дмитровская', 'Савёловская', 'Менделеевская', 'Цветной бульвар', 'Чеховская', 'Боровицкая', 'Полянка', 'Серпуховская', 'Тульская', 'Нагатинская', 'Нагорная', 'Нахимовский проспект', 'Севастопольская', 'Чертановская', 'Южная', 'Пражская', 'Улица Академика Янгеля', 'Аннино', 'Бульвар Дмитрия Донского',
])
// Люблинско-Дмитровская (10)
addStations(L10, [
  'Селигерская', 'Верхние Лихоборы', 'Окружная', 'Петровско-Разумовская', 'Фонвизинская', 'Бутырская', 'Марьина Роща', 'Достоевская', 'Трубная', 'Сретенский бульвар', 'Чкаловская', 'Рижская', 'Алексеевская', 'ВДНХ', 'Ботанический сад', 'Ростокино', 'Белокаменная', 'Бульвар Рокоссовского', 'Локомотив', 'Измайлово', 'Соколиная Гора', 'Шоссе Энтузиастов', 'Авиамоторная', 'Площадь Ильича', 'Марксистская', 'Печатники', 'Текстильщики', 'Волжская', 'Люблино', 'Братиславская', 'Марьино', 'Борисово', 'Шипиловская', 'Зябликово',
])
// Каховская (11)
addStations(L11, [
  'Каховская', 'Варшавская', 'Каширская', 'Каховская',
])
// Бутовская (12)
addStations(L12, [
  'Битцевский парк', 'Лесопарковая', 'Улица Старокачаловская', 'Улица Скобелевская', 'Бульвар Адмирала Ушакова', 'Улица Горчакова', 'Бунинская аллея',
])
// Некрасовская (15)
addStations(L14, [
  'Некрасовка', 'Лухмановская', 'Улица Дмитриевского', 'Косино', 'Юго-Восточная', 'Окская', 'Стахановская', 'Нижегородская', 'Авиамоторная', 'Лефортово', 'Электрозаводская', 'Сокольники', 'Рижская', 'Марьина Роща', 'Селигерская',
])

const FALLBACK_COLORS = [L1, L2, L3, L4, L5, L6, L7, L8, L9, L10, L11, L12, L14]

/**
 * Возвращает цвет линии метро по названию станции.
 * Для известных станций — официальный цвет линии, иначе — по хэшу из палитры.
 */
export function metroLineColor(stationName: string | undefined): string {
  if (!stationName || typeof stationName !== 'string') return FALLBACK_COLORS[0]
  const key = stationName.trim().toLowerCase()
  if (STATION_TO_COLOR[key]) return STATION_TO_COLOR[key]
  let h = 0
  for (let i = 0; i < key.length; i++) h = (h * 31 + key.charCodeAt(i)) >>> 0
  return FALLBACK_COLORS[h % FALLBACK_COLORS.length]
}
